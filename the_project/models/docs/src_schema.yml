version: 2

sources:
  - name: src
    schema: "{{ env_var('DB_SCHEMA_SRC', 'src') }}"
    config:
      freshness:
        warn_after:
          period: hour
          count: 6
    loaded_at_field: "created_at"
    tables:
      - name: products
        tags: [ "{{ env_var('DB_SCHEMA_SRC', 'src') }}", "source", "raw", "external", "products" ]
        description: "{{ doc('source_table') }}"
      - name: customers
        tags: [ "{{ env_var('DB_SCHEMA_SRC', 'src') }}", "source", "raw", "external", "customers" ]
        description: "{{ doc('source_table') }}"
      - name: orders
        description: "{{ doc('source_heap_table') }}"
        loaded_at_field: "order_purchased_at"
      - name: order_items
        description: "{{ doc('source_heap_table') }}"
        freshness: null
      - name: products_delayed
        description: "Simulates late arriving IDs to be excluded in staging"
      - name: customers_delayed
        description: "Simulates late arriving IDs to be excluded in staging"
      - name: orders_delayed
        description: "Simulates late arriving IDs to be excluded in staging"
